/*
 * Paint.java
 *
 * Created on 8 de abril de 2008, 09:00 PM
 */

package paint;

import java.awt.image.RenderedImage;
import java.io.File;
import javax.imageio.ImageIO;
import javax.swing.JOptionPane;

/**
 *
 * @author  oocf
 */
public class Paint extends javax.swing.JFrame {
    PanelDibujo lienzo=new PanelDibujo();
    boolean color=true;
    /** Creates new form Paint */
    public Paint() {
        initComponents();
        lienzo.setBounds(25, 25, 300, 300);
        this.add(lienzo);
        frmColor.pack();
        frmGuardar.pack();
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        frmColor = new javax.swing.JFrame();
        colores = new javax.swing.JColorChooser();
        btnAceptar = new javax.swing.JButton();
        btnCancelar = new javax.swing.JButton();
        frmGuardar = new javax.swing.JFrame();
        selecDirec = new javax.swing.JFileChooser();
        jToolBar1 = new javax.swing.JToolBar();
        btnSave = new javax.swing.JButton();
        btnLapiz = new javax.swing.JButton();
        btnLinea = new javax.swing.JButton();
        btnCirculo = new javax.swing.JButton();
        btnColor = new javax.swing.JButton();
        btnFondo = new javax.swing.JButton();
        chkRelleno = new javax.swing.JCheckBox();

        btnAceptar.setText("Aceptar");
        btnAceptar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAceptarActionPerformed(evt);
            }
        });

        btnCancelar.setText("Cancelar");
        btnCancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCancelarActionPerformed(evt);
            }
        });

        org.jdesktop.layout.GroupLayout frmColorLayout = new org.jdesktop.layout.GroupLayout(frmColor.getContentPane());
        frmColor.getContentPane().setLayout(frmColorLayout);
        frmColorLayout.setHorizontalGroup(
            frmColorLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(org.jdesktop.layout.GroupLayout.TRAILING, frmColorLayout.createSequentialGroup()
                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .add(colores, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
            .add(frmColorLayout.createSequentialGroup()
                .add(70, 70, 70)
                .add(btnAceptar)
                .add(77, 77, 77)
                .add(btnCancelar)
                .addContainerGap(131, Short.MAX_VALUE))
        );
        frmColorLayout.setVerticalGroup(
            frmColorLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(frmColorLayout.createSequentialGroup()
                .add(colores, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
                .add(frmColorLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                    .add(btnAceptar)
                    .add(btnCancelar))
                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        selecDirec.setDialogType(javax.swing.JFileChooser.SAVE_DIALOG);
        selecDirec.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                selecDirecActionPerformed(evt);
            }
        });

        org.jdesktop.layout.GroupLayout frmGuardarLayout = new org.jdesktop.layout.GroupLayout(frmGuardar.getContentPane());
        frmGuardar.getContentPane().setLayout(frmGuardarLayout);
        frmGuardarLayout.setHorizontalGroup(
            frmGuardarLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(0, 500, Short.MAX_VALUE)
            .add(frmGuardarLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                .add(frmGuardarLayout.createSequentialGroup()
                    .add(0, 0, Short.MAX_VALUE)
                    .add(selecDirec, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                    .add(0, 0, Short.MAX_VALUE)))
        );
        frmGuardarLayout.setVerticalGroup(
            frmGuardarLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(0, 326, Short.MAX_VALUE)
            .add(frmGuardarLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                .add(frmGuardarLayout.createSequentialGroup()
                    .add(0, 0, Short.MAX_VALUE)
                    .add(selecDirec, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                    .add(0, 0, Short.MAX_VALUE)))
        );

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("PaintO");

        jToolBar1.setRollover(true);

        btnSave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/paint/save.png"))); // NOI18N
        btnSave.setFocusable(false);
        btnSave.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnSave.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSaveActionPerformed(evt);
            }
        });
        jToolBar1.add(btnSave);

        btnLapiz.setIcon(new javax.swing.ImageIcon(getClass().getResource("/paint/pencil.png"))); // NOI18N
        btnLapiz.setFocusable(false);
        btnLapiz.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnLapiz.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnLapiz.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLapizActionPerformed(evt);
            }
        });
        jToolBar1.add(btnLapiz);

        btnLinea.setIcon(new javax.swing.ImageIcon(getClass().getResource("/paint/linea.png"))); // NOI18N
        btnLinea.setFocusable(false);
        btnLinea.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnLinea.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnLinea.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLineaActionPerformed(evt);
            }
        });
        jToolBar1.add(btnLinea);

        btnCirculo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/paint/ellipse.png"))); // NOI18N
        btnCirculo.setFocusable(false);
        btnCirculo.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnCirculo.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnCirculo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCirculoActionPerformed(evt);
            }
        });
        jToolBar1.add(btnCirculo);

        btnColor.setText("Color");
        btnColor.setFocusable(false);
        btnColor.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnColor.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnColor.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnColorActionPerformed(evt);
            }
        });
        jToolBar1.add(btnColor);

        btnFondo.setText("Fondo");
        btnFondo.setFocusable(false);
        btnFondo.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnFondo.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnFondo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnFondoActionPerformed(evt);
            }
        });
        jToolBar1.add(btnFondo);

        chkRelleno.setText("Rellenar");
        chkRelleno.setFocusable(false);
        chkRelleno.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        chkRelleno.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        chkRelleno.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chkRellenoActionPerformed(evt);
            }
        });
        jToolBar1.add(chkRelleno);

        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(jToolBar1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 400, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .add(jToolBar1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 25, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(275, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSaveActionPerformed
        frmGuardar.setVisible(true);
    }//GEN-LAST:event_btnSaveActionPerformed

    private void btnLapizActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLapizActionPerformed
        lienzo.lapiz=1;
        lienzo.linea=0;
        lienzo.circulo=0;
    }//GEN-LAST:event_btnLapizActionPerformed

    private void btnLineaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLineaActionPerformed
        lienzo.lapiz=0;
        lienzo.linea=1;
        lienzo.circulo=0;
    }//GEN-LAST:event_btnLineaActionPerformed

    private void btnCirculoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCirculoActionPerformed
        lienzo.lapiz=0;
        lienzo.linea=0;
        lienzo.circulo=1;
    }//GEN-LAST:event_btnCirculoActionPerformed

    private void btnColorActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnColorActionPerformed
        color=true;
        frmColor.setVisible(true);
    }//GEN-LAST:event_btnColorActionPerformed

    private void btnFondoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnFondoActionPerformed
        color=false;
        frmColor.setVisible(true);
    }//GEN-LAST:event_btnFondoActionPerformed

    private void chkRellenoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chkRellenoActionPerformed
        if(chkRelleno.isSelected()){
            lienzo.relleno=true;
        }else{
            lienzo.relleno=false;
        }
    }//GEN-LAST:event_chkRellenoActionPerformed

    private void btnAceptarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAceptarActionPerformed
        if(color){
            lienzo.seleccion=colores.getColor();
        }else{
            lienzo.fondo=colores.getColor();
        }
        frmColor.setVisible(false);
}//GEN-LAST:event_btnAceptarActionPerformed

    private void btnCancelarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCancelarActionPerformed
        frmColor.setVisible(false);
}//GEN-LAST:event_btnCancelarActionPerformed

    private void selecDirecActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_selecDirecActionPerformed
        System.out.println(evt.getActionCommand());
        if(evt.getActionCommand().equals("ApproveSelection")){

            if(selecDirec.getSelectedFile()!=null){
                File salida= selecDirec.getSelectedFile();
                if(!salida.getAbsolutePath().endsWith("png")){
                    File t = new File(salida.getAbsolutePath()+"png");
                    salida.renameTo(t);
                }
                
                RenderedImage rend = lienzo.getImage();
                try{
                    ImageIO.write(rend, "png", salida);
                    JOptionPane.showMessageDialog(this,"Se completo la grabacion con exito", "Grabacion Completada", 
                            JOptionPane.INFORMATION_MESSAGE);
                }catch(Exception e){}
            }
        }
        frmGuardar.setVisible(false);
    }//GEN-LAST:event_selecDirecActionPerformed
    
    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Paint().setVisible(true);
            }
        });
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAceptar;
    private javax.swing.JButton btnCancelar;
    private javax.swing.JButton btnCirculo;
    private javax.swing.JButton btnColor;
    private javax.swing.JButton btnFondo;
    private javax.swing.JButton btnLapiz;
    private javax.swing.JButton btnLinea;
    private javax.swing.JButton btnSave;
    private javax.swing.JCheckBox chkRelleno;
    private javax.swing.JColorChooser colores;
    private javax.swing.JFrame frmColor;
    private javax.swing.JFrame frmGuardar;
    private javax.swing.JToolBar jToolBar1;
    private javax.swing.JFileChooser selecDirec;
    // End of variables declaration//GEN-END:variables
    
}
